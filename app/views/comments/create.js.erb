<% publish_to '/games' do %>
  var id = <%= @comment.call_id || @comment.challenge_id %>

  console.log( $('.thing_' + id).find('input#comment_text')[0] )

  <% if @comment.challenge_id.present? %>

    $('.challenge_thing_' + id).find('form').append('<%= j(render 'comment', :comment => @comment) %>');
    $('.challenge_thing_' + id).find('.comment_count_' + id).replaceWith('<%= j(render 'counter', :thing => @comment.challenge) %>');

  <% elsif @comment.call_id.present? %>

    $('.call_thing_' + id).find('form').append('<%= j(render 'comment', :comment => @comment) %>');
    $('.call_thing_' + id).find('.comment_count_' + id).replaceWith('<%= j(render 'counter', :thing => @comment.call) %>');
  <% end %>

  $("input#comment_text").val("");
<% end %>
